# 分子動力学法(1) 理論的背景と実装の詳細

* 分子動力学法の種類
* 位相空間と流れ
* 時間積分

## 位相空間と流れ

分子動力学法は、ニュートンの運動方程式を数値的に解くことで、何か新たな知見を得る手法だ。ニュートンの運動方程式は$F=ma$、つまり、力は加速度と質量に比例する、というものだ。このニュートンの運動方程式について詳しく見てみよう。

まず、加速度$a$とは、速度$v$の時間変化率のことだ。したがって、

$$
a = \frac{dv}{dt}
$$

また、速度とは、位置の時間変化率のことだ。

$$
v = \frac{dx}{dt}
$$

したがって、ニュートンの運動方程式とは、位置に関する二階の常微分方程式となる。

$$
m \frac{d^2 x}{dt^2} = F
$$

一般に、高階微分方程式は扱いづらいので、一階の微分方程式の連立方程式に落とす。

$$
\begin{aligned}
\frac{dv}{dt} &= \frac{F}{m}\\
\frac{dx}{dt} &= v
\end{aligned}
$$

さて、位置の関数$V(r)$があり、力がその微分で書ける、すなわち$F=-V'(r)$であるとしよう。このような場合、力をポテンシャル力と呼び、$V(r)$をポテンシャルと呼ぶ。すると、運動方程式は以下のようになる。

$$
\begin{aligned}
\frac{dv}{dt} &= -\frac{V'(r)}{m}\\
\frac{dx}{dt} &= v
\end{aligned}
$$

この式をよく見ると、変数$(r,v)$の時間微分が、変数$(r,v)$自身で表現されている。一般的に書くと以下のようになる。

$$
\begin{aligned}
\frac{dv}{dt} &= f(r,v)\\
\frac{dx}{dt} &= g(r,v)
\end{aligned}
$$

このように系の変数の時間微分が系の変数自身で表現されている時、この系を **力学系(dynamical system)** と呼ぶ。運動方程式は力学系の一種である。

例として、バネで繋がれた質点の運動を考えよう。面倒なのでばね定数も質量も1としよう。運動方程式は

$$
\begin{aligned}
\frac{dv}{dt} &= -x\\
\frac{dx}{dt} &= v
\end{aligned}
$$

となる。いま、位置が0、速度が$v$であるとしよう。これは、質点がバネの自然長の位置にいて、初速を与えられた状況に対応する。この瞬間はバネの伸びはゼロであるから、位置は増加、速度は変化しない。したがって、$(\dot{v}, \dot{x}) = (0, v)$だ。

逆に、バネが伸び切った状態を考えよう。速度はゼロで、位置が$x$とする。質点は停止しているので位置は動かない$(\dot{x}=0)$。一方、質点はバネに引っ張られているため、速度はマイナスの方向に加速される$(\dot{v} = -x)$。以上から、$(\dot{v}, \dot{x}) = (-x, 0)$

一般に、速度$v$、位置$x$の状態にある時、それぞれの時間微分は$(\dot{v}, \dot{x}) = (-x, v)$で表現できる。
