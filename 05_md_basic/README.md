# 分子動力学法(1) 理論的背景と実装の詳細

* 分子動力学法の種類
* 位相空間と流れ
* 時間積分

## 位相空間と流れ

分子動力学法は、ニュートンの運動方程式を数値的に解くことで、何か新たな知見を得る手法だ。ニュートンの運動方程式は$F=ma$、つまり、力は加速度と質量に比例する、というものだ。このニュートンの運動方程式について詳しく見てみよう。

まず、加速度$a$とは、速度$v$の時間変化率のことだ。したがって、

$$
a = \frac{dv}{dt}
$$

また、速度とは、位置の時間変化率のことだ。

$$
v = \frac{dr}{dt}
$$

したがって、ニュートンの運動方程式とは、位置に関する二階の常微分方程式となる。

$$
m \frac{d^2 r}{dt^2} = F
$$

一般に、高階微分方程式は扱いづらいので、一階の微分方程式の連立方程式に落とす。

$$
\begin{aligned}
\frac{dv}{dt} &= \frac{F}{m} \\
\frac{dr}{dt} &= v
\end{aligned}
$$

さて、位置の関数$V(r)$があり、力がその微分で書ける、すなわち$F=-V'(r)$であるとしよう。このような場合、力をポテンシャル力と呼び、$V(r)$をポテンシャルと呼ぶ。すると、運動方程式は以下のようになる。

$$
\begin{aligned}
\frac{dv}{dt} &= -\frac{V'(r)}{m}\\
\frac{dr}{dt} &= v
\end{aligned}
$$

この式をよく見ると、変数$(v,r)$の時間微分が、変数$(v,r)$自身で表現されている。一般的に書くと以下のようになる。

$$
\begin{aligned}
\frac{dv}{dt} &= f_v(r,v)\\
\frac{dr}{dt} &= f_r(r,v)
\end{aligned}
$$

このように系の変数の時間微分が系の変数自身で表現されている時、この系を **力学系(dynamical system)** と呼ぶ。運動方程式は力学系の一種である。

例として、バネで繋がれた質点の運動を考えよう。面倒なのでばね定数も質量も1としよう。すると、ポテンシャルは$V(x) = x^2/2$なので、力は$-V'(x)= -x$だ。

運動方程式は

$$
\begin{aligned}
\frac{dr}{dt} &= v\\
\frac{dv}{dt} &= -r
\end{aligned}
$$

となる。

この系は、速度$v$と位置$r$のを指定すると状態が定まり、そこから過去、及び未来の軌跡が完全に定まる。このような空間$(v,r)$を **位相空間(phase space)**と呼ぶ。一方、運動方程式として$r$の二階微分方程式を考える。

$$
\frac{d^2r}{dt^2} = -r
$$

この系では、独立変数は$x$だけだが、$x$を指定するだけでは運動が定まらない。例えば$t=0$で$x=0$であったとして、この物体が止まっているのか、動いているのかは$\dot{x}$の情報が無いとわからない。そして、$(x, \dot{x})$の情報がわかれば、二階微分以上の情報は不要だ。このように、与えられた運動方程式の運動を過不足なく表現できる空間が位相空間である。この系の状態は$(x,v)$、すなわち位相空間上の点で表現され、時間発展はこの点の軌跡で表現される。

さて、ある時刻において位置が$0$、速度が$v$であるとしよう。これは、質点がバネの自然長の位置にいて、初速を与えられた状況に対応する。この瞬間はバネの伸びはゼロであるから、位置は増加、速度は変化しない。したがって、$(\dot{x}, \dot{v}) = (0, v)$だ。

逆に、バネが伸び切った状態を考えよう。速度はゼロで、位置が$x$とする。質点は停止しているので位置は動かない$(\dot{x}=0)$。一方、質点はバネに引っ張られているため、速度はマイナスの方向に加速される$(\dot{v} = -x)$。以上から、$(\dot{x},\dot{v}) = (-x, 0)$となる。

こうして位相空間の各点において時間微分$(\dot{x},\dot{v})$を記入していくと、位相空間にベクトル場が定義される。このベクトル場はこのベクトルは「この点が次にどこに向かって動くべきか」を表現している。すなわち運動方程式は位相空間$(x,v)$に、ベクトル場($\dot{x},\dot(v))$を関連付けるものであり、このベクトル場は位相空間に速度場を定義する。特に、調和振動子の場合は、原点を中心として反時計回りに回転する流れを引き起こす。この世界において、どこかの点にトレーサーを置くと、あとは流れ場に沿って動き始める。このトレーサーの軌跡が運動方程式の解だ。すなわち、運動方程式の解とは、位相空間における回転運動であるとみなすことができる。この事実は後ほどまた触れる。

## 極小作用の原理

力学系は、自由度の数だけ時間微分を与える必要がある。例えば$(x,y,z)$の三次元空間の力学系を考えるなら、この世界の運動を定めるためには

$$
\begin{aligned}
\dot{x} &= f_x(x,y,z)\\
\dot{y} &= f_y(x,y,z)\\
\dot{z} &= f_z(x,y,z)\\
\end{aligned}
$$

と、$(x,y,z)$の関数を三本決めなくてはならない。三次元空間中の$N$個の質点の運動を表現するためには、自由度が$6N$個であるから、$6N$個の引数を持つ関数を$6N$個定める必要がある。しかし、ラグランジアンという$6N$個の引数を持つただ一つの関数を使うことで、$6N$個の微分方程式を得ることができる。この仕組みが変分原理である。

### ラグランジアンと作用積分

### ルジャンドル変換とハミルトニアン

## 位相空間の流れ再び
